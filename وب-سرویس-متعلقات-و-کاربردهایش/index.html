<!doctype html><html lang=fa dir=rtl><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>وب سرویس: متعلقات و کاربردهایش | یحیی صیاداربابی</title><meta name=keywords content><meta name=description content="وب‌سرویس، API، Restful و &mldr; چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم."><meta name=author content="Yahya"><link rel=canonical href=https://fa.theyahya.com/%D9%88%D8%A8-%D8%B3%D8%B1%D9%88%DB%8C%D8%B3-%D9%85%D8%AA%D8%B9%D9%84%D9%82%D8%A7%D8%AA-%D9%88-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1%D8%AF%D9%87%D8%A7%DB%8C%D8%B4/><link crossorigin=anonymous href=/assets/css/stylesheet.f6432f4e5c3ea00170464301b00e114b967e9ae5d8734ada53ee8322ad5a2b72.css integrity="sha256-9kMvTlw+oAFwRkMBsA4RS5Z+muXYc0raU+6DIq1aK3I=" rel="preload stylesheet" as=style><link rel=icon href=https://fa.theyahya.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fa.theyahya.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fa.theyahya.com/favicon-32x32.png><link rel=apple-touch-icon href=https://fa.theyahya.com/apple-touch-icon.png><link rel=mask-icon href=https://fa.theyahya.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100..900&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-SZWG7TS62Y"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SZWG7TS62Y",{anonymize_ip:!1})}</script><meta property="og:title" content="وب سرویس: متعلقات و کاربردهایش"><meta property="og:description" content="وب‌سرویس، API، Restful و &mldr; چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم."><meta property="og:type" content="article"><meta property="og:url" content="https://fa.theyahya.com/%D9%88%D8%A8-%D8%B3%D8%B1%D9%88%DB%8C%D8%B3-%D9%85%D8%AA%D8%B9%D9%84%D9%82%D8%A7%D8%AA-%D9%88-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1%D8%AF%D9%87%D8%A7%DB%8C%D8%B4/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-08-22T09:01:51+00:00"><meta property="article:modified_time" content="2016-08-22T09:01:51+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="وب سرویس: متعلقات و کاربردهایش"><meta name=twitter:description content="وب‌سرویس، API، Restful و &mldr; چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://fa.theyahya.com/posts/"},{"@type":"ListItem","position":2,"name":"وب سرویس: متعلقات و کاربردهایش","item":"https://fa.theyahya.com/%D9%88%D8%A8-%D8%B3%D8%B1%D9%88%DB%8C%D8%B3-%D9%85%D8%AA%D8%B9%D9%84%D9%82%D8%A7%D8%AA-%D9%88-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1%D8%AF%D9%87%D8%A7%DB%8C%D8%B4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"وب سرویس: متعلقات و کاربردهایش","name":"وب سرویس: متعلقات و کاربردهایش","description":"وب‌سرویس، API، Restful و \u0026hellip; چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم.","keywords":[],"articleBody":"وب‌سرویس، API، Restful و … چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم.\nفرض کنید قصد نوشتن امکان لایک کردن مطالب (پست‌ها، ویدیو یا هرچیزی که وب اپلیکیشن‌تون ارائه میده) رو دارید. چه می‌کنیم؟! برای شروع یک html ساده می‌نویسیم تا بتونیم دکمه لایک رو نشون بدیم.\ndemo like like0 و با فرمت html یا php ذخیره‌اش می‌کنیم. توضیح خاصی هم نداره، تو خط ۷ یک دکمه ساختم که کلمه‌ like رو نشون بده و داخلش یک span با آی‌دی count که تعداد لایک‌های پست رو نمایش بده. بعد یک فایل بنام server.php می‌سازیم و کد زیر رو داخلش اضافه می‌کنیم.\n\u003c?php $numLikes = ++$_GET['likes']; echo json_encode(array( 'status' =\u003e true, 'num_likes' =\u003e $numLikes, )); درواقع در خط دوم متغییر likes رو با متد GET گرفتیم و بعد از اینکه یک واحد بهش اضافه کردیم در متغییر $numLikes ذخیره‌ش کردیم. در خطوط 3 تا 6 هم یک آرایه ساختیم و بعد از تبدیل کردنش به json با echo چاپش کردیم. که تنها خروجی صفحه‌مون هست.\nخب حالا بریم html اولیه رو کمی تغییر بدیم تا نوشتن چند خط جاوا اسکریپت بتونیم با ajax دکمه‌ی لایک رو را بندازیم. نسخه‌ی جدید فایل html میشه کد زیر:\ndemo like like 0 در خط 23 بهش گفتیم بعد از کلیک شدن تابع like رو اجرا کن. در تابع لایک هم به این صورت عمل کردیم که: -خط 6: تعداد لایک‌های فعلی رو از spanای که آی‌دی count داشت گرفتیم و در numLikes ذخیره‌ش کردیم. -خط 7:‌یک نمونه از کلاس XMLHttpRequest می‌سازیم. -خط 8: لیک درخواست‌مون رو برای server.php خودمون تعریف می‌کنیم و با استفاده از GET مقدار likes رو هم براش می‌فرستیم. -خط 9 و 10: چیزی شبیه بازکردن کانکشن هست. -خط 18: درخواست ارسال میشه. -خط 11: بررسی میشه که پاسخ درخواست بطور کامل دریافت شده باشه و http status code هم برابر 200 یعنی ok باشه. (یکی از نمونه‌های معروف http status code ؛ کد 404 هست که وقتی صفحه پیدا نمیشه نمایش داده میشه) [لیست کامل http status codeها](https://en.wik P_status_codes). همچنین در مواردی مثل همین دکمه‌ی لایک یا چیزهایی مثل دکمه‌ی فالو می‌تونیم برای کاهش حجم اطلاعاتی که از سمت سرور میاد بدون اینکه هیچ خروجی (json) نشون بدیم صرفا با تعریف http status code در سمت سرور و بررسی‌شون با javascript در سمت سرور ازشون استفاده کنیم. هرچند به همین شکل هم حجم اطاعات دریافتی خیلی پایین هست.\n-خط 12: پاسخ رو بصورت جیسون parse می‌کنیم و در response ذخیره‌اش می‌کنیم.\n-خط 13و 14: اگر پاسخ‌ سرور true بود (چیزی که خودمون بعد از بررسی‌های سمت سرور تعیین می‌کنیم؛ مثل اینکه کاربر دوبار لایک نکنه یا بررسی دسترسی و … که اینجا هیچ‌یک رو انجام ندادیم) مقدار count رو هم به مقدار جدید تغییر می‌دیم.\nخب حالا فرض کنیم که فایل server.php یک وب‌سرویس هست که ما فقط لینک‌ش رو داریم و می‌خوایم در برنامه‌ی php مون ازش استفاده کنیم. برای گرفتن وضعیت آب‌وهوا چنین چنین نمونه‌هایی وجود داره و API هایی که برنامه‌های بزرگی مثل Telegram و اینستاگرام ارائه میدن پایه‌ی ساختارشون همین هست.\nو یکی از مزایای جالب‌شون این هست که اهمیتی نداره با چه زبان برنامه‌نویسی کار می‌کنید و روی چه پلتفرمی هستید، از همه‌جا می‌تونید ازشون استفاده کنید. مثلا یک سایت هواشناسی بود که API خیلی خوبی برای وضعیت آب‌وهوا ارائه داده بود که حتی شهر‌های کوچیک ایران رو هم داشت و تمام این‌ها رو بصورت رایگان می‌داد. که تو یک پروژه روی اپ اندروید وضعیت آب‌وهوا رو با جزئیات کاملی مثل: رطوبت، جهت وزش باد، دما و… رو نمایش دادم.\nدر php این کار رو با کتابخونه‌ی curl انجام می‌دیم که حدودا از نسخه‌ی 4 به بعد php با خود php ارائه میشه ولی اگر از نسخه‌های قبل استفاده می‌کنید باید بصورت جداگانه نصب‌ش کنید.\nپس کد php زیر رو می‌نویسم روی فایل curl.php ذخیره می‌کنیم:\n\u003c?php $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, 'http://test.dev/server.php?likes=5'); curl_setopt($curl, CURLOPT_RETURNTRANSFER, true); $json = curl_exec($curl); curl_close($curl); $res = json_decode($json); echo 'status = ' . $res-\u003estatus; echo '\n'; echo 'likes = ' . $res-\u003enum_likes; -خط ۲:‌ curl رو مقداردهی اولیه یا initialize می‌کنیم.\n-خط ۳: به curlمون آپشن url میدیم، که urlای که شما می‌دید باید چیزی که روی لوکال هاست خودتون هست بدید و احتمالا متفاونت با چیزی هست که من نوشتم، ولی به همون فایل server.php مون باشه و مقدار likes رو هم حتما بفرستید.\n-خط ۴:‌ آپشن returnTransfer رو برابر true قرار می‌دیم،‌ چیزی شبیه اینکه اگر صفحه ریدایرکت شد تو هم ریدایرکت شو و مقدار رو هم بصورت string برگردون.\n-خط ۵: curl رو اجرا می‌کنیم و خروجی رو در متغییر $json می‌ریزیم.\n-خط ۶: curl رو می‌بندیم! توصیه‌ی من این هست که همیشه curl رو ببندید ولی من تابحال با نبستن‌ش مشکلی برام پیش نیومده!\n-خط ۷: JSON رو به آرایه تبدیل می‌کنیم و در $res می‌ریزم.\n-خط 8، 9 و ۱۰: نمایش مقادیر لایک و status.\nفایل‌های این پروژه رو می‌تونید از اینجا دانلود کنید.\nپ.ن ۱: توجه داشته باشید که این مثال‌ها صرفا آموزشی هستند و در پروژه‌های واقعی ممکنه فایل server.php مون یک mvc با چندهزار خط کد باشه و بعد از کلی بررسی در database و سروکله زدن با modelها بهمون همین خروجی ساده رو بده. و حتی ممکنه خروجی هم به این سادگی نباشه.\nپ.ن۲: در پروژه‌های واقعی معمولا از متد POST و یا چیزهای جالب دیگه هم برای ردوبدل کردن اطلاعات استفاده میشه، که اینجا ما فقط با متند GET کار کردیم تا ساده‌تر و مفهوم‌تر باشه. و برای خروجی هم ممکنه xml یا hjson که اخیرا نظرم رو جلب کرده بکار بره.\n","wordCount":"1034","inLanguage":"fa","datePublished":"2016-08-22T09:01:51Z","dateModified":"2016-08-22T09:01:51Z","author":{"@type":"Person","name":"Yahya"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fa.theyahya.com/%D9%88%D8%A8-%D8%B3%D8%B1%D9%88%DB%8C%D8%B3-%D9%85%D8%AA%D8%B9%D9%84%D9%82%D8%A7%D8%AA-%D9%88-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1%D8%AF%D9%87%D8%A7%DB%8C%D8%B4/"},"publisher":{"@type":"Organization","name":"یحیی صیاداربابی","logo":{"@type":"ImageObject","url":"https://fa.theyahya.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://fa.theyahya.com/ accesskey=h title="یحیی صیاداربابی (Alt + H)">یحیی صیاداربابی</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">وب سرویس: متعلقات و کاربردهایش</h1><div class=post-meta><span title='2016-08-22 09:01:51 +0000 UTC'>اوت 22, 2016</span>&nbsp;·&nbsp;5 دقیقه&nbsp;·&nbsp;Yahya</div></header><div class=post-content><p>وب‌سرویس، API، Restful و &mldr; چیزهایی هستند که هر برنامه‌نویسی اگر نگیم بطور روزمره، حتما بصورت مداوم باهاشون سر و کار داره و از هربار کار کردن با این‌ها هم مفاهیم و تکنیک‌های جدید یاد می‌گیره. دراینجا قصد تعریف این مفاهیم رو نداریم چون علاوه براینکه زیاد به تعاریف نیازی نداریم، ویکی‌پدیا قبلا خیلی بهتر از ما این‌کار رو انجام داده! اینجا فقط قصد ارائه‌ی چند مثال کاربردی بسیار ساده و پایه‌ای حول این مفاهیم و البته توضیح کامل‌شون داریم.</p><p>فرض کنید قصد نوشتن امکان لایک کردن مطالب (پست‌ها، ویدیو یا هرچیزی که وب اپلیکیشن‌تون ارائه میده) رو دارید. چه می‌کنیم؟! برای شروع یک html ساده می‌نویسیم تا بتونیم دکمه لایک رو نشون بدیم.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>	&lt;title&gt;demo like&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;/script&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>	&lt;button &gt;like&lt;span id=&#34;count&#34;&gt;0&lt;/span&gt;&lt;/button&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span></code></pre></div><p>و با فرمت html یا php ذخیره‌اش می‌کنیم. توضیح خاصی هم نداره، تو خط ۷ یک دکمه ساختم که کلمه‌ like رو نشون بده و داخلش یک span با آی‌دی count که تعداد لایک‌های پست رو نمایش بده.
بعد یک فایل بنام server.php می‌سازیم و کد زیر رو داخلش اضافه می‌کنیم.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$numLikes <span style=color:#f92672>=</span> <span style=color:#f92672>++</span>$_GET[<span style=color:#e6db74>&#39;likes&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>json_encode</span>(<span style=color:#66d9ef>array</span>(
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#39;status&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#39;num_likes&#39;</span> <span style=color:#f92672>=&gt;</span> $numLikes,
</span></span><span style=display:flex><span>));
</span></span></code></pre></div><p>درواقع در خط دوم متغییر likes رو با متد GET گرفتیم و بعد از اینکه یک واحد بهش اضافه کردیم در متغییر $numLikes ذخیره‌ش کردیم. در خطوط 3 تا 6 هم یک آرایه ساختیم و بعد از تبدیل کردنش به json با echo چاپش کردیم. که تنها خروجی صفحه‌مون هست.</p><p>خب حالا بریم html اولیه رو کمی تغییر بدیم تا نوشتن چند خط جاوا اسکریپت بتونیم با ajax دکمه‌ی لایک رو را بندازیم. نسخه‌ی جدید فایل html میشه کد زیر:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;html&gt;
</span></span><span style=display:flex><span>&lt;head&gt;
</span></span><span style=display:flex><span>	&lt;title&gt;demo like&lt;/title&gt;
</span></span><span style=display:flex><span>	&lt;script type=&#34;text/javascript&#34;&gt;
</span></span><span style=display:flex><span>	function like(){
</span></span><span style=display:flex><span>		var numLikes = document.getElementById(&#39;count&#39;).innerHTML;
</span></span><span style=display:flex><span>		var http = new XMLHttpRequest();
</span></span><span style=display:flex><span>		var url = &#34;server.php?likes=&#34; + numLikes;
</span></span><span style=display:flex><span>		http.open(&#34;GET&#34;, url, true);
</span></span><span style=display:flex><span>		http.onreadystatechange = function() {
</span></span><span style=display:flex><span>		    if(http.readyState == 4 &amp;&amp; http.status == 200) {
</span></span><span style=display:flex><span>		        var response = JSON.parse(http.responseText);
</span></span><span style=display:flex><span>		        if(response.status){
</span></span><span style=display:flex><span>		        	document.getElementById(&#39;count&#39;).innerHTML = response.num_likes;
</span></span><span style=display:flex><span>		        }
</span></span><span style=display:flex><span>		    }
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		http.send();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	&lt;/script&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;
</span></span><span style=display:flex><span>&lt;body&gt;
</span></span><span style=display:flex><span>	&lt;button onclick=&#34;like()&#34;&gt;like &lt;span id=&#34;count&#34;&gt;0&lt;/span&gt;&lt;/button&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span></code></pre></div><p>در خط 23 بهش گفتیم بعد از کلیک شدن تابع like رو اجرا کن. در تابع لایک هم به این صورت عمل کردیم که:
-خط 6: تعداد لایک‌های فعلی رو از spanای که آی‌دی count داشت گرفتیم و در numLikes ذخیره‌ش کردیم.
-خط 7:‌یک نمونه از کلاس XMLHttpRequest می‌سازیم.
-خط 8: لیک درخواست‌مون رو برای server.php خودمون تعریف می‌کنیم و با استفاده از GET مقدار likes رو هم براش می‌فرستیم.
-خط 9 و 10: چیزی شبیه بازکردن کانکشن هست.
-خط 18: درخواست ارسال میشه.
-خط 11: بررسی میشه که پاسخ درخواست بطور کامل دریافت شده باشه و http status code هم برابر 200 یعنی ok باشه. (یکی از نمونه‌های معروف http status code ؛ کد 404 هست که وقتی صفحه پیدا نمیشه نمایش داده میشه) [لیست کامل http status codeها](<a href=https://en.wik>https://en.wik</a> P_status_codes). همچنین در مواردی مثل همین دکمه‌ی لایک یا چیزهایی مثل دکمه‌ی فالو می‌تونیم برای کاهش حجم اطلاعاتی که از سمت سرور میاد بدون اینکه هیچ خروجی (json) نشون بدیم صرفا با تعریف http status code در سمت سرور و بررسی‌شون با javascript در سمت سرور ازشون استفاده کنیم. هرچند به همین شکل هم حجم اطاعات دریافتی خیلی پایین هست.</p><p>-خط 12: پاسخ رو بصورت جیسون parse می‌کنیم و در response ذخیره‌اش می‌کنیم.</p><p>-خط 13و 14: اگر پاسخ‌ سرور true بود (چیزی که خودمون بعد از بررسی‌های سمت سرور تعیین می‌کنیم؛ مثل اینکه کاربر دوبار لایک نکنه یا بررسی دسترسی و &mldr; که اینجا هیچ‌یک رو انجام ندادیم) مقدار count  رو هم به مقدار جدید تغییر می‌دیم.</p><p>خب حالا فرض کنیم که فایل server.php یک وب‌سرویس هست که ما فقط لینک‌ش رو داریم و می‌خوایم در برنامه‌ی php مون ازش استفاده کنیم. برای گرفتن وضعیت آب‌وهوا چنین چنین نمونه‌هایی وجود داره و <a href=https://en.wikipedia.org/wiki/Application_programming_interface>API</a> هایی که برنامه‌های بزرگی مثل Telegram و اینستاگرام ارائه میدن پایه‌ی ساختارشون همین هست.</p><p>و یکی از مزایای جالب‌شون این هست که اهمیتی نداره با چه زبان برنامه‌نویسی کار می‌کنید و روی چه پلتفرمی هستید، از همه‌جا می‌تونید ازشون استفاده کنید. مثلا یک سایت هواشناسی بود که API خیلی خوبی برای وضعیت آب‌وهوا ارائه داده بود که حتی شهر‌های کوچیک ایران رو هم داشت و تمام این‌ها رو بصورت رایگان می‌داد. که تو یک پروژه روی اپ اندروید وضعیت آب‌وهوا رو با جزئیات کاملی مثل: رطوبت، جهت وزش باد، دما و&mldr; رو نمایش دادم.</p><p>در php این کار رو با کتابخونه‌ی curl انجام می‌دیم که حدودا از نسخه‌ی 4 به بعد php با خود php ارائه میشه ولی اگر از نسخه‌های قبل استفاده می‌کنید باید بصورت جداگانه نصب‌ش کنید.</p><p>پس کد php زیر رو می‌نویسم روی فایل curl.php ذخیره می‌کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$curl <span style=color:#f92672>=</span> <span style=color:#a6e22e>curl_init</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>curl_setopt</span>($curl, <span style=color:#a6e22e>CURLOPT_URL</span>, <span style=color:#e6db74>&#39;http://test.dev/server.php?likes=5&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>curl_setopt</span>($curl, <span style=color:#a6e22e>CURLOPT_RETURNTRANSFER</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>$json <span style=color:#f92672>=</span> <span style=color:#a6e22e>curl_exec</span>($curl);
</span></span><span style=display:flex><span><span style=color:#a6e22e>curl_close</span>($curl);
</span></span><span style=display:flex><span>$res <span style=color:#f92672>=</span> <span style=color:#a6e22e>json_decode</span>($json);
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;status = &#39;</span> <span style=color:#f92672>.</span> $res<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>status</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;&lt;br&gt;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#39;likes = &#39;</span> <span style=color:#f92672>.</span> $res<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>num_likes</span>;
</span></span></code></pre></div><p>-خط ۲:‌ curl  رو مقداردهی اولیه یا initialize می‌کنیم.</p><p>-خط ۳: به curlمون آپشن url میدیم، که urlای که شما می‌دید باید چیزی که روی لوکال هاست خودتون هست بدید و احتمالا متفاونت با چیزی هست که من نوشتم، ولی به همون فایل server.php مون باشه و مقدار likes رو هم حتما بفرستید.</p><p>-خط ۴:‌ آپشن returnTransfer  رو برابر true قرار می‌دیم،‌ چیزی شبیه اینکه اگر صفحه ریدایرکت شد تو هم ریدایرکت شو و مقدار رو هم بصورت string برگردون.</p><p>-خط ۵: curl رو اجرا می‌کنیم و خروجی رو در متغییر $json می‌ریزیم.</p><p>-خط ۶: curl رو می‌بندیم! توصیه‌ی من این هست که همیشه curl  رو ببندید ولی من تابحال با نبستن‌ش مشکلی برام پیش نیومده!</p><p>-خط ۷: JSON رو به آرایه تبدیل می‌کنیم و در $res می‌ریزم.</p><p>-خط 8، 9 و ۱۰: نمایش مقادیر لایک  و status.</p><p>فایل‌های این پروژه رو می‌تونید از <a href=http://ysarbabi.ir/blog/wp-content/uploads/demo.zip><strong>اینجا</strong></a> دانلود کنید.</p><p>پ.ن ۱: توجه داشته باشید که این مثال‌ها صرفا آموزشی هستند و در پروژه‌های واقعی ممکنه فایل server.php مون یک mvc با چندهزار خط کد باشه و بعد از کلی بررسی در database و سروکله زدن با modelها بهمون همین خروجی ساده رو بده. و حتی ممکنه خروجی هم به این سادگی نباشه.</p><p>پ.ن۲: در پروژه‌های واقعی معمولا از متد POST و یا چیزهای جالب دیگه هم برای ردوبدل کردن اطلاعات استفاده میشه، که اینجا ما فقط با متند GET کار کردیم تا ساده‌تر و مفهوم‌تر باشه. و برای خروجی هم ممکنه xml یا <a href=https://hjson.org/>hjson</a> که اخیرا نظرم رو جلب کرده بکار بره.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://fa.theyahya.com/%D9%85%D8%B9%D8%B1%D9%81%DB%8C-%D8%B3%D8%B1%DB%8C%D8%A7%D9%84-stranger-things/><span class=title>« صفحه قبلی</span><br><span>معرفی سریال Stranger Things</span></a>
<a class=next href=https://fa.theyahya.com/%D9%85%D9%88%D8%B6%D9%88%D8%B9-%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D8%B9%D9%84%D9%85-%D8%A8%D9%87%D8%AA%D8%B1-%D8%A7%D8%B3%D8%AA-%DB%8C%D8%A7-%D8%AB%D8%B1%D9%88%D8%AA%D8%9F/><span class=title>صفحه بعدی »</span><br><span>موضوع انشاء: علم بهتر است یا ثروت؟!</span></a></nav><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){this.page.identifier="112 http://ysarbabi.ir/blog/?p=112"},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//fa-theyahya-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share وب سرویس: متعلقات و کاربردهایش on x" href="https://x.com/intent/tweet/?text=%d9%88%d8%a8%20%d8%b3%d8%b1%d9%88%db%8c%d8%b3%3a%20%d9%85%d8%aa%d8%b9%d9%84%d9%82%d8%a7%d8%aa%20%d9%88%20%da%a9%d8%a7%d8%b1%d8%a8%d8%b1%d8%af%d9%87%d8%a7%db%8c%d8%b4&amp;url=https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share وب سرویس: متعلقات و کاربردهایش on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f&amp;title=%d9%88%d8%a8%20%d8%b3%d8%b1%d9%88%db%8c%d8%b3%3a%20%d9%85%d8%aa%d8%b9%d9%84%d9%82%d8%a7%d8%aa%20%d9%88%20%da%a9%d8%a7%d8%b1%d8%a8%d8%b1%d8%af%d9%87%d8%a7%db%8c%d8%b4&amp;summary=%d9%88%d8%a8%20%d8%b3%d8%b1%d9%88%db%8c%d8%b3%3a%20%d9%85%d8%aa%d8%b9%d9%84%d9%82%d8%a7%d8%aa%20%d9%88%20%da%a9%d8%a7%d8%b1%d8%a8%d8%b1%d8%af%d9%87%d8%a7%db%8c%d8%b4&amp;source=https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share وب سرویس: متعلقات و کاربردهایش on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share وب سرویس: متعلقات و کاربردهایش on whatsapp" href="https://api.whatsapp.com/send?text=%d9%88%d8%a8%20%d8%b3%d8%b1%d9%88%db%8c%d8%b3%3a%20%d9%85%d8%aa%d8%b9%d9%84%d9%82%d8%a7%d8%aa%20%d9%88%20%da%a9%d8%a7%d8%b1%d8%a8%d8%b1%d8%af%d9%87%d8%a7%db%8c%d8%b4%20-%20https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share وب سرویس: متعلقات و کاربردهایش on telegram" href="https://telegram.me/share/url?text=%d9%88%d8%a8%20%d8%b3%d8%b1%d9%88%db%8c%d8%b3%3a%20%d9%85%d8%aa%d8%b9%d9%84%d9%82%d8%a7%d8%aa%20%d9%88%20%da%a9%d8%a7%d8%b1%d8%a8%d8%b1%d8%af%d9%87%d8%a7%db%8c%d8%b4&amp;url=https%3a%2f%2ffa.theyahya.com%2f%25D9%2588%25D8%25A8-%25D8%25B3%25D8%25B1%25D9%2588%25DB%258C%25D8%25B3-%25D9%2585%25D8%25AA%25D8%25B9%25D9%2584%25D9%2582%25D8%25A7%25D8%25AA-%25D9%2588-%25DA%25A9%25D8%25A7%25D8%25B1%25D8%25A8%25D8%25B1%25D8%25AF%25D9%2587%25D8%25A7%25DB%258C%25D8%25B4%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="کپی";function s(){t.innerHTML="کپی شد!",setTimeout(()=>{t.innerHTML="کپی"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>